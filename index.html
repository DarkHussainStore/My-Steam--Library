<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مكتبة STEAM</title>
  <meta name="theme-color" content="#004d40" id="themeColorMeta">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <video autoplay muted loop playsinline id="bgVideo" aria-hidden="true" tabindex="-1">
    <source src="https://cdn.videvo.net/videvo_files/video/free/2013-08/small_watermarked/blue_background_preview.webm" type="video/webm" />
    <source src="https://cdn.discordapp.com/attachments/1339436496574349404/1374507188868874330/astronaut-on-blooming-planet.960x540.mp4?ex=682f9e92&is=682e4d12&hm=7090d2360168de171b4fff438d115c86b836ebf32d74b2f2e1481f702fbdcfe6&" type="video/mp4" />
    متصفحك لا يدعم تشغيل الفيديو.
  </video>
  <style>
    /* تم نقل جميع أكواد CSS إلى ملف CSS خارجي للحفاظ على الكود نظيفًا ومنظمًا.
       الرجاء إنشاء ملف style.css ولصق الأكواد هناك. */
    :root {
      --primary-color: #004d40;
      --primary-light: #00bfa5;
      --text-light: #e0f2f1;
      --text-dark: #004d40;
      --shadow-color: rgba(0, 255, 230, 0.7);
      --card-gradient: linear-gradient(145deg, #004d4044, #00241e88);
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: var(--text-light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
      scroll-behavior: smooth;
      overflow-x: hidden;
      position: relative;
    }

    button, .card, #mainNav ul li a {
      cursor: pointer;
    }

    button:focus-visible, .card:focus-visible, #mainNav ul li a:focus-visible {
      outline: 3px solid #00f2cc;
      outline-offset: 4px;
    }

    #mainNav {
      position: fixed;
      top: 0;
      width: 100%;
      height: 48px;
      box-shadow: 0 4px 15px #a7ffebcc;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 12000;
      font-weight: 700;
      font-size: 1.1rem;
      transition: background-color 0.3s ease;
    }

    #usernameDisplay {
      align-items: center;
      border-radius: 10px;
      box-shadow: inset 0 0 12px #00f2ccbb;
      color: #a7ffebee;
      padding: 4px 12px; /* تم إضافة padding لتحسين المظهر */
      margin-right: 15px; /* تم إضافة هامش لتحسين المسافة */
    }

    #mainNav ul {
      list-style: none;
      display: flex;
      gap: 32px;
      margin: 0;
      padding: 0;
      align-items: center; /* لمحاذاة العناصر عمودياً */
    }

    #mainNav ul li a {
      color: #a7ffebcc;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 8px;
      transition: all 0.35s ease;
      box-shadow: 0 0 5px transparent;
    }

    #mainNav ul li a:hover,
    #mainNav ul li a:focus {
      background-color: var(--primary-light);
      color: var(--primary-color);
      box-shadow: 0 0 12px #00f2ccdd;
      transform: scale(1.1);
    }







    #logoutBtn {
      background: var(--primary-color);
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: #a7ffebcc;
      font-weight: 700;
      font-family: 'Cairo', sans-serif;
      cursor: pointer;
      box-shadow: 0 0 5px transparent;
      transition: all 0.35s ease;
    }

    #logoutBtn:hover,
    #logoutBtn:focus {
      background: linear-gradient(135deg, #f70707, #790000);
      color: white; /* تغيير لون النص ليتناسب مع الخلفية الحمراء */
      box-shadow: 0 0 12px #f70707dd; /* تغيير ظل المربع ليتناسب */
      transform: scale(1.1);
    }

    /* خلفية الفيديو */
    #bgVideo {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -1;
      filter: brightness(0.35) saturate(1.3) contrast(1.15);
      transition: filter 0.5s ease;
    }

    /* ملاحظة: قسم nav هذا مكرر في كودك الأصلي، تم تركه للوضوح ولكن يجب إزالته */
    /* nav {
      background-color: #333;
      color: white;
      padding: 0 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 50px;
    }
    nav .logo {
      font-size: 20px;
      font-weight: bold;
    }
    nav ul {
      list-style: none;
      display: flex;
      margin: 0;
      padding: 0;
    }
    nav ul li {
      margin-left: 20px;
    }
    nav ul li a {
      color: white;
      text-decoration: none;
      font-size: 16px;
    } */

    #topBar .siteTitle {
      letter-spacing: 0.1em;
      font-size: 1.5rem;
      text-shadow: 0 0 8px #00f2ccbb;
    }

    #topBar .userSection {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    #topBar .usernameDisplay {
      background: #00796bdd;
      padding: 8px 20px;
      border-radius: 24px;
      font-family: 'Courier New', monospace;
      max-width: 220px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      box-shadow: 0 0 12px #00f2ccaa inset;
      font-weight: 700;
    }

    .back-to-top {
      position: fixed;
      bottom: 25px;
      right: 25px;
      z-index: 999;
      background-color: #00bfa5;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 0 10px #a7ffebcc;
      display: none;
      transition: all 0.3s ease;
      color: var(--primary-color); /* لجعل السهم مرئيًا */
    }

    .back-to-top:hover {
      transform: scale(1.1);
      background-color: var(--primary-light);
    }

    .back-to-top:focus {
      outline: 3px solid #00f2cc;
      outline-offset: 4px;
    }

    #mainContainer, header, #searchInput {
      margin-top: 120px;
      width: 90%;
      max-width: 1200px;
      transition: margin-top 0.3s ease;
    }

    header {
      font-size: 3rem;
      font-weight: 900;
      margin-bottom: 10px;
      text-shadow: 0 0 20px #26a69a;
      letter-spacing: 0.08em;
      text-align: center;
    }

    #gamesCount {
      text-align: center;
      margin-bottom: 25px;
      font-size: 1.1rem;
      font-weight: 700;
      color: #00f2ccdd;
      letter-spacing: 0.04em;
    }

    #mainContainer {
      display: flex;
      gap: 28px;
      margin-bottom: 70px;
      min-height: 75vh;
      position: relative;
      z-index: 10;
    }

    #filtersPanel {
      flex: 0 0 240px;
      background: #00000044;
      border-radius: 22px;
      padding: 28px 22px;
      box-shadow: 0 0 36px #000000aa inset;
      color: #a7ffebdd;
      transition: box-shadow 0.3s ease;
    }

    #filtersPanel:hover {
      box-shadow: 0 0 50px #00f2ccdd inset;
    }

    #filtersPanel h2 {
      margin-top: 0;
      font-weight: 900;
      font-size: 1.2rem;
      margin-bottom: 26px;
      text-align: center;
      letter-spacing: 0.05em;
    }

    #filtersPanel label {
      display: block;
      margin-bottom: 18px;
      font-size: 1.2rem;
      transition: color 0.3s ease;
      cursor: pointer;
    }

    #filtersPanel label:hover {
      color: #00f2cc;
    }

    #filtersPanel input[type="checkbox"] {
      margin-left: 12px;
      width: 22px;
      height: 22px;
      vertical-align: middle;
      accent-color: var(--primary-light);
      transition: accent-color 0.3s ease;
    }

    #filtersPanel input[type="checkbox"]:hover {
      accent-color: #00f2cc;
    }

    .cards-container {
      flex-grow: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 32px;
      perspective: 1300px;
      transition: all 0.3s ease;
    }

    .card {
      background: var(--card-gradient);
      border-radius: 28px;
      box-shadow:
        0 10px 28px var(--shadow-color),
        inset 0 0 20px #00f2ccbb;
      overflow: hidden;
      transition:
        transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1),
        box-shadow 0.4s ease,
        background-color 0.4s ease,
        filter 0.6s ease;
      display: flex;
      flex-direction: column;
      will-change: transform;
      outline-offset: 6px;
      color: #a7ffebee;
      position: relative;
    }

    .card:hover,
    .card:focus-visible {
      transform: scale(1.1);
      box-shadow:
        0 38px 72px rgba(0, 255, 230, 1),
        inset 0 0 38px #00f2ccdd;
      outline: 4px solid #00f2ccdd;
      outline-offset: 5px;
      background: linear-gradient(145deg, #005d40ee, #009e76ee);
      color: #d4fff9;
      filter: drop-shadow(0 0 20px #00f2ccff);
      z-index: 10;
      animation: cardGlow 3s ease-in-out infinite;
    }

    @keyframes cardGlow {
      0%, 100% {
        box-shadow:
          0 38px 72px rgba(0, 255, 230, 1),
          inset 0 0 38px #00f2ccdd;
      }
      50% {
        box-shadow:
          0 48px 82px rgba(0, 255, 230, 1),
          inset 0 0 48px #00f2ccff;
      }
    }

    .card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-bottom: 5px solid #00bfa577;
      transition: transform 0.35s ease, filter 0.35s ease;
      border-top-left-radius: 28px;
      border-top-right-radius: 28px;
    }

    .card:hover img,
    .card:focus-visible img {
      transform: scale(1.07);
      filter: drop-shadow(0 0 18px #00f2ccdd);
    }

    .card h3 {
      margin: 18px 20px 8px;
      font-weight: 900;
      font-size: 1.7rem;
      text-align: center;
      letter-spacing: 0.05em;
    }

    .card .game-type {
      font-size: 1.1rem;
      font-weight: 600;
      text-align: center;
      margin-bottom: 20px;
      color: #f8f8f85b;
      letter-spacing: 0.025em;
      font-style: italic;
      padding: 5px 0; /* تم إضافة padding لتحسين المظهر */
    }

    mark {
      background: #00f2cc77;
      color: var(--primary-color);
      font-weight: 900;
      padding: 0 3px;
      border-radius: 3px;
    }

    .credentials {
      margin: 0 20px 20px;
      font-family: 'Courier New', monospace;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .credential-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #00332b99;
      border-radius: 12px;
      padding: 8px 16px;
      box-shadow: inset 0 0 12px #00f2ccbb;
      color: #a7ffebee;
      font-size: 1rem;
    }

    .credential-label {
      font-weight: 700;
      min-width: 80px;
    }

    .credential-value {
      flex-grow: 1;
      padding: 0 10px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* نمط نافذة التأكيد */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 77, 64, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 20000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: linear-gradient(145deg, #004d40, #00796b);
      padding: 30px;
      border-radius: 20px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 0 30px rgba(0, 255, 230, 0.7);
      text-align: center;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .modal.show .modal-content {
      transform: scale(1);
    }

    .modal-content h3 {
      color: #a7ffeb;
      font-size: 1.8rem;
      margin-bottom: 20px;
      text-shadow: 0 0 10px #00f2cc;
    }

    .modal-content p {
      color: #e0f2f1;
      font-size: 1.2rem;
      margin-bottom: 30px;
    }

    .modal-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    .modal-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 30px;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Cairo', sans-serif;
    }

    .confirm-btn {
      background-color: #e53935;
      color: white;
      box-shadow: 0 0 15px rgba(229, 57, 53, 0.5);
    }

    .confirm-btn:hover {
      background-color: #c62828;
      box-shadow: 0 0 25px rgba(229, 57, 53, 0.8);
      transform: translateY(-3px);
    }

    .cancel-btn {
      background-color: #00796b;
      color: #e0f2f1;
      box-shadow: 0 0 15px rgba(0, 191, 165, 0.5);
    }

    .cancel-btn:hover {
      background-color: #00bfa5;
      box-shadow: 0 0 25px rgba(0, 255, 230, 0.8);
      transform: translateY(-3px);
    }

    .copy-btn {
      background: #00bfa5cc;
      border: none;
      color: var(--primary-color);
      font-weight: 700;
      border-radius: 8px;
      padding: 6px 14px;
      box-shadow: 0 0 8px #00f2ccbb;
      transition: all 0.3s ease;
      position: relative;
    }

    .copy-btn:hover {
      background-color: #00f2cc;
      box-shadow: 0 0 20px #00f2cc;
    }

    .copy-btn[aria-label]:hover::after {
      content: attr(aria-label);
      position: absolute;
      bottom: 125%;
      right: 50%;
      transform: translateX(50%);
      background: #00bfa5dd;
      color: var(--primary-color);
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 0.85rem;
      white-space: nowrap;
      box-shadow: 0 0 6px #00f2ccdd;
      opacity: 0.9;
    }


#clock {
  font-size: 24px;  /* الحجم الافتراضي للنص */
}

/* لما يكون عرض الشاشة أصغر من 600 بكسل */
@media (max-width: 600px) {
  #clock {
    font-size: 16px;  /* يصغر حجم النص */
  }
}
    #clock {
      position: fixed;
      top: 10px;
      left: 10px;
      color: #a7ffeb;
      font-size: 1.1rem;
      font-weight: 700;
      z-index: 10000;
      text-shadow: 0 0 8px #00f2ccbb;
      background-position-x: 
      center;
    }


    


    #searchInput {
      margin: 0 auto 6px auto;
      width: 90%;
      max-width: 460px;
      padding: 16px 22px;
      font-size: 1.35rem;
      border-radius: 50px;
      border: none;
      box-shadow: 0 0 24px #00bfa5cc inset;
      color: var(--primary-color);
      font-weight: 800;
      letter-spacing: 0.03em;
      font-family: 'Cairo', sans-serif;
      transition: box-shadow 0.35s ease;
    }

    #searchInput::placeholder {
      color: #00bfa599;
      font-weight: 700;
      font-style: italic;
    }

    #searchInput:focus {
      outline: none;
      box-shadow: 0 0 40px #00f2ccff inset;
      color: #00261a;
    }

    .toast {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background: #00bfa5dd;
      color: var(--primary-color);
      padding: 14px 26px;
      border-radius: 30px;
      font-weight: 700;
      box-shadow: 0 0 12px #00f2cccc;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
      z-index: 20000;
    }

    .toast.show {
      opacity: 1;
      pointer-events: auto;
    }

    #scrollTopBtn {
      position: fixed;
      bottom: 50px;
      right: 30px;
      background-color: #00bfa5cc;
      color: var(--primary-color);
      border: none;
      padding: 14px 18px;
      border-radius: 50px;
      font-weight: 700;
      box-shadow: 0 0 10px #00f2cccc;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 13000;
    }

    #scrollTopBtn.show {
      opacity: 1;
      visibility: visible;
    }

    #scrollTopBtn:hover {
      background-color: #00f2cc;
      box-shadow: 0 0 18px #00f2cc;
      transform: scale(1.1);
    }

    #mouseCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 1000;
    }

    #colorPicker {
  position: fixed;
  bottom: 20px;
  left: 50%;
  display: flex;
  gap: 12px;
  z-index: 13000;
}




.color-btn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  box-shadow: 0 0 8px rgb(255, 255, 255);
  border: 2px solid transparent;
  background-color: transparent;
  display: inline-block;
  transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.44s ease;
  cursor: pointer;
}

/* عند تمرير الماوس على الزر */
.color-btn:hover {
  transform: scale(1.1);
}

/* الزر عند اختياره */
.color-btn.selected {
  border-color: #00f2cc;
  box-shadow: 0 0 12px #00f2cc, inset 0 0 5px #00f2cc;
  transform: scale(1.1);
}

@media (max-width: 600px) {
  .fixed-button {
    padding: 10px 20px;
    font-size: 14px;
  }
}

    @media (max-width: 950px) {
      #mainContainer {
        flex-direction: column;
      }

      #filtersPanel {
        width: 100%;
        margin-bottom: 25px;
        border-radius: 24px;
      }

      .cards-container {
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        width: 100%;
      }

      #gamesCount {
        font-size: 1rem;
      }
    }

    @media (max-width: 500px) {
      .card h3 {
        font-size: 1.3rem;
      }

      .card .game-type {
        font-size: 1rem;
      }

      #searchInput {
        max-width: 100%;
        font-size: 1.2rem;
        padding: 14px 18px;
      }

      .credentials {
        margin: 0 12px 12px;
      }

      .credential-label {
        min-width: 70px;
      }

      .copy-btn {
        padding: 5px 10px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>


  
<div id="logoutModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
  <div class="modal-content">
    <h3 id="modalTitle">تأكيد الخروج</h3>
    <p>هل أنت متأكد أنك تريد تسجيل الخروج؟</p>
    <div class="modal-actions">
      <button id="confirmLogout" class="modal-btn confirm-btn">نعم، سجل خروج</button>
      <button id="cancelLogout" class="modal-btn cancel-btn">إلغاء</button>
    </div>
  </div>
</div>

<nav id="mainNav" role="navigation" aria-label="القائمة الرئيسية">
  <ul>
    <li><a href="admin.html">المكتبة</a></li>
    <li><a href="reals.html">قوانين</a></li>
    <li><button id="logoutBtn" aria-label="تسجيل الخروج">تسجيل خروج</button></li>
    <li style="display: flex; align-items: center;">
      اسم المستخدم ← <span id="usernameDisplay" aria-live="polite" aria-atomic="true">-</span>
    </li>
    <button class="color-btn" style="background-color: #00241e;" data-color="#00241e" aria-label="اختر اللون الأخضر الزمردي" ></button>
 
  <button class="color-btn" style="background-color: #00695c;" data-color="#00695c" aria-label="اختر اللون الأخضر الداكن" ></button>
  <button class="color-btn" style="background-color: #3cfde7;" data-color="#3cfde7" aria-label="اختر اللون الأخضر الفاتح" ></button>
  </ul>

</nav>


<header>مكتبة STEAM</header>

<input type="search" id="searchInput" placeholder="ابحث عن لعبة..." aria-label="بحث في الألعاب" autocomplete="off" spellcheck="false" />
<div id="gamesCount" aria-live="polite" aria-atomic="true">جاري تحميل الألعاب...</div>

<main id="mainContainer">
  <aside id="filtersPanel" aria-label="فلاتر تصنيف الألعاب">
    <h2>أنواع الألعاب</h2>
    <label><input type="checkbox" value="أكشن" checked /> أكشن</label>
    <label><input type="checkbox" value="حرب" checked /> حرب</label>
    <label><input type="checkbox" value="سباق" checked /> سباق</label>
    <label><input type="checkbox" value="مغامرات" checked /> مغامرات</label>
    <label><input type="checkbox" value="ألغاز" checked /> ألغاز</label>
    <label><input type="checkbox" value="استراتيجية" checked /> استراتيجية</label>
    <label><input type="checkbox" value="تــجــربــه" checked />تــجــربــه</label>
  </aside>

  <section class="cards-container" id="gamesContainer" aria-label="قائمة الألعاب">
    </section>
</main>


<button id="backToTop" class="back-to-top" title="العودة للأعلى" aria-label="العودة للأعلى">🢁</button>

<canvas id="mouseCanvas"></canvas>

<div id="toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"></div>


<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script>
  AOS.init({
    duration: 1000,
    once: true, // Animation only happens once
  });

  // --- بداية كود تغيير لون المتصفح وجميع القوائم والأزرار ---
  function changeBrowserColor(color, btnElement = null) {
    document.documentElement.style.setProperty('--primary-color', color);
    document.documentElement.style.setProperty('--primary-light', shadeColor(color, 20));
    document.documentElement.style.setProperty('--shadow-color', `${color}cc`);
    document.documentElement.style.setProperty('--card-gradient', `linear-gradient(145deg, ${color}44, ${shadeColor(color, -20)}88)`);

    // تحديث لون شريط التنقل
    const mainNav = document.getElementById('mainNav');
    mainNav.style.backgroundColor = color + 'bb'; // شفافية طفيفة

    // تحديث ألوان الروابط في شريط التنقل
    document.querySelectorAll('#mainNav ul li a').forEach(a => {
      a.style.color = getContrastYIQ(color);
      a.addEventListener('mouseenter', () => {
        a.style.backgroundColor = shadeColor(color, 20);
        a.style.color = getContrastYIQ(shadeColor(color, 20));
      });
      a.addEventListener('mouseleave', () => {
        a.style.backgroundColor = 'transparent';
        a.style.color = getContrastYIQ(color);
      });
    });

    const logoutBtn = document.getElementById('logoutBtn');
    logoutBtn.style.color = getContrastYIQ(color);
    logoutBtn.style.backgroundColor = color;

    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.style.color = getContrastYIQ(shadeColor(color, 20));
      btn.style.backgroundColor = shadeColor(color, 20);
    });

    const scrollBtn = document.getElementById('scrollTopBtn'); // استخدام زر العودة للأعلى
    scrollBtn.style.color = getContrastYIQ(shadeColor(color, 20));
    scrollBtn.style.backgroundColor = shadeColor(color, 20);

    const metaThemeColor = document.getElementById('themeColorMeta');
    if(metaThemeColor) {
      metaThemeColor.setAttribute('content', color);
    }

    // إزالة تحديد اللون السابق وتحديد اللون الجديد
    document.querySelectorAll('#colorPicker .color-btn').forEach(btn => {
      btn.classList.remove('selected');
    });
    if(btnElement) btnElement.classList.add('selected');

    // تحديث لون الخلفية للفيديو
    const bgVideo = document.getElementById('bgVideo');
    // يمكن هنا تعديل filter بناءً على اللون، لكنه سيبقى ثابتًا لسهولة الصيانة
  }

  function shadeColor(color, percent) {
    let f = parseInt(color.slice(1), 16);
    let t = percent < 0 ? 0 : 255;
    let p = percent < 0 ? percent * -1 : percent;
    let R = f >> 16;
    let G = f >> 8 & 0x00FF;
    let B = f & 0x0000FF;
    return `#${(0x1000000 + (Math.round((t - R) * p / 100) + R) * 0x10000 +
              (Math.round((t - G) * p / 100) + G) * 0x100 +
              (Math.round((t - B) * p / 100) + B)).toString(16).slice(1)}`;
  }

  function getContrastYIQ(hexcolor){
    hexcolor = hexcolor.replace('#','');
    const r = parseInt(hexcolor.substr(0,2),16);
    const g = parseInt(hexcolor.substr(2,2),16);
    const b = parseInt(hexcolor.substr(4,2),16);
    const yiq = ((r*299)+(g*587)+(b*114))/1000;
    return (yiq >= 128) ? '#000' : '#fff';
  }

  window.addEventListener('DOMContentLoaded', () => {
    // تحديد اللون الافتراضي عند تحميل الصفحة
    const defaultBtn = document.querySelector('#colorPicker button[data-color="#004d40"]');
    if (defaultBtn) {
      changeBrowserColor('#004d40', defaultBtn);
    } else {
      changeBrowserColor('#004d40'); // في حالة عدم وجود الزر الافتراضي
    }
  });

  document.getElementById('mainNav').addEventListener('click', (e) => {
    if (e.target.classList.contains('color-btn')) {
      const color = e.target.dataset.color;
      changeBrowserColor(color, e.target);
    }
  });
  // --- نهاية كود تغيير اللون ---

  // --- بيانات الألعاب ---
  const games = [
    {
      id: 'game1',
      name: 'The Planet Crafter',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374543981567803475/cBqNakijS_ZSKvGmCX8W9Q.jpeg?ex=682e6f56&is=682d1dd6&hm=1cd23ce3eb91981044814be33571d2f06d345ee4044c777873a7f496f6981021&',
      username: 'ggqqxx5830',
      password: 'sS94qwjsplay',
      type: 'مغامرات'
    },
    {
      id: 'game2',
      name: 'The Escapists',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374468790921986078/photo_2025-05-20_22-28-00.jpg?ex=68336f50&is=68321dd0&hm=3b3b638fd99ee9cf65dc514dabc46fe44063b2eaff40e65f523bd8453b9af40a&',
      username: 'vovan159rus',
      password: '94529452',
      type: 'أكشن'
    },
    {
      id: 'game3',
      name: 'Dark souls 3',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374543153494884442/DS3.webp?ex=682e6e91&is=682d1d11&hm=fc77d2f136dc016eb45fc2f6d84eca1bc39362a19c41abea8cc6b8cdd0476433&',
      username: 'soull312',
      password: 'ZPRWHeVnYNQ@@',
      type: 'مغامرات'
    },
    {
      id: 'game4',
      name: 'Bully: Scholarship Edition',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374547230450516099/maxresdefault.jpg?ex=682e725d&is=682d20dd&hm=757b1bdb6a7e9cee3b48414350498795293809d705abe8e313d49b9af7cf4839&',
      username: 'fatriya_diqqi23',
      password: '15https://t.me/SHAREDSTEAM',
      type: 'ألغاز'
    },
    {
      id: 'game5',
      name: 'Arma 3',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374548531968348291/0010469_arma-3.jpeg?ex=683310d3&is=6831bf53&hm=d3c409c9a71af9d3d7a0a4f4625156f7b52bd37c6b8475fc4d819b77846b6d2a&',
      username: 'mingxiangkulian',
      password: 'KOsa0z74FcL62jW',
      type: 'حرب'
    },
    {
      id: 'game6',
      name: 'Resident Evil 4',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374563135414861824/resident-evil-4.jpg?ex=68331e6d&is=6831cced&hm=9b7366fad27613f25a308d659bd7a498e29f6fef3c97c5dd73995cc123fc17ff&',
      username: 'charles_3612x',
      password: '4chxBWBpMnf',
      type: 'ألغاز'
    },
    {
      id: 'game7',
      name: 'Ark Survival Evolved',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374570745937662064/ark-survival-evolved-1024x576.jpg?ex=682e8844&is=682d36c4&hm=70643de085ac3bde044418aadfe74588fa01af2ceca3111c01de7f9b26dc0951&',
      username: 'minhboang',
      password: 'minhhaha11',
      type: 'مغامرات'
    },
    {
      id: 'game8',
      name: 'Forza Horizon 5',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1374574548753842196/11.png?ex=682e8bce&is=682d3a4e&hm=dfd9f748b9ef865d7cf9fb5f7dd0b4d4710780e999c1b92e96c017b478a12caa&',
      username: 'bej01201',
      password: 'Bejdw11201',
      type: 'سباق'
    },

  {
    id: 'game9',
      name: 'Pay Day 2',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1375962141718347786/download-payday-2-full-cho-pc-khiphach.jpg?ex=6833981a&is=6832469a&hm=420e9538c7cebf0eb5fe6b5c79d00761f1636dd752ee4b4f9676c862f1e39e4c&', // تم تغيير الصورة لربطها بصورة صالحة
      username: 'steamok1090206',
      password: 'steamok888777',
      type: 'أكشن'
    },


{
    id: 'game10',
      name: 'People Playground',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1375962580748865566/maxresdefault_1.jpg?ex=68339883&is=68324703&hm=ec1d6b1771b01b513dc1a397ffdf3c30e4b97b0e35235315f00324f4f2b2d705&', // تم تغيير الصورة لربطها بصورة صالحة
      username: 'steamok1090206',
      password: 'steamok888777',
      type: 'تــجــربــه'
    },



    {
    id: 'game11',
      name: 'Besiege',
      img: 'https://cdn.discordapp.com/attachments/1339436496574349404/1375962108583219232/Besiege-coverr-600x338.jpg?ex=68339812&is=68324692&hm=167c435268a93cbfea26fe785e3d899181a3e0ddc4c4e59703f7237ce989fc08&', // تم تغيير الصورة لربطها بصورة صالحة
      username: 'steamok1090206',
      password: 'steamok888777',
      type: 'أكشن'
    }


    
  ];

  // --- متغيرات DOM ---
  const container = document.getElementById('gamesContainer');
  const searchInput = document.getElementById('searchInput');
  const filterCheckboxes = document.querySelectorAll('#filtersPanel input[type="checkbox"]');
  const gamesCount = document.getElementById('gamesCount');
  const usernameDisplay = document.getElementById('usernameDisplay');
  const logoutBtn = document.getElementById('logoutBtn');
  const toast = document.getElementById('toast');
  const backToTopBtn = document.getElementById('backToTop'); // استخدام backToTopBtn

  // --- تهيئة المستخدم ---
  const loggedInUser = sessionStorage.getItem('loggedInUser') || 'ضيف';
  usernameDisplay.textContent = loggedInUser;

  // --- متغيرات نافذة التأكيد ---
  const logoutModal = document.getElementById('logoutModal');
  const confirmLogoutBtn = document.getElementById('confirmLogout');
  const cancelLogoutBtn = document.getElementById('cancelLogout');

  // --- معالجة تسجيل الخروج ---
  logoutBtn.addEventListener('click', (e) => {
    e.preventDefault();
    logoutModal.classList.add('show');
    logoutModal.setAttribute('aria-hidden', 'false');
  });

  // تحديث الساعة باستمرار
  setInterval(() => {
    const now = new Date();
    document.getElementById("clock").textContent = now.toLocaleString('ar-SA', {
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      day: '2-digit',
      month: '2-digit',
      year: 'numeric'
    });
  }, 1000);

  // تأكيد الخروج
  confirmLogoutBtn.addEventListener('click', () => {
    sessionStorage.removeItem('loggedInUser');
    window.location.href = 'login.html';
  });

  // إلغاء الخروج
  cancelLogoutBtn.addEventListener('click', () => {
    logoutModal.classList.remove('show');
    logoutModal.setAttribute('aria-hidden', 'true');
  });

  // إغلاق النافذة عند النقر خارجها
  logoutModal.addEventListener('click', (e) => {
    if (e.target === logoutModal) {
      logoutModal.classList.remove('show');
      logoutModal.setAttribute('aria-hidden', 'true');
    }
  });

  // إغلاق النافذة بالزر Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && logoutModal.classList.contains('show')) {
      logoutModal.classList.remove('show');
      logoutModal.setAttribute('aria-hidden', 'true');
    }
  });

  // --- وظائف العرض ---
  function showToast(message) {
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2500);
  }

  async function copyText(text, label) {
    try {
      await navigator.clipboard.writeText(text);
      // clickAudio.currentTime = 0; // تم إزالة هذا السطر لأن clickAudio لم يتم تعريفه في النطاق هذا.
      // await clickAudio.play().catch(() => {}); // تم إزالة هذا السطر.
      showToast(`تم نسخ ${label} بنجاح!`);
    } catch {
      showToast('فشل النسخ، حاول مرة أخرى.');
    }
  }

  function highlightText(text, term) {
    if (!term) return text;
    const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
    return text.replace(regex, '<mark>$1</mark>');
  }

  function renderGames(filteredGames, highlightTerm = '') {
    if (filteredGames.length === 0) {
      container.innerHTML = `<p style="color:#00fffacc; text-align:center; font-size:1.2rem;">لم يتم العثور على ألعاب مطابقة للبحث أو الفلاتر.</p>`;
      gamesCount.textContent = '0: لعبة معروضة';
      return;
    }

    gamesCount.textContent = `${filteredGames.length} : لعبة${filteredGames.length > 1 ? ' معروضة' : ' معروضة'}`;

    container.innerHTML = filteredGames.map(game => `
      <article class="card" tabindex="0" role="button" aria-pressed="false" aria-label="فتح معلومات لعبة ${game.name}">
        <img src="${game.img}" alt="صورة لعبة ${game.name}" loading="lazy" />
        <h3>${highlightText(game.name, highlightTerm)}</h3>
        <p class="game-type">${game.type || 'غير محدد'}</p>
        <div class="credentials">
          <div class="credential-row">
            <span class="credential-label">اسم المستخدم:</span>
            <span class="credential-value">${game.username}</span>
            <button class="copy-btn" data-copy-target="username" aria-label="نسخ اسم المستخدم" title="نسخ اسم المستخدم">نسخ</button>
          </div>
          <div class="credential-row">
            <span class="credential-label">كلمة السر:</span>
            <span class="credential-value">${game.password}</span>
            <button class="copy-btn" data-copy-target="password" aria-label="نسخ كلمة السر" title="نسخ كلمة السر">نسخ</button>
          </div>
        </div>
      </article>
    `).join('');

    // إضافة معالجات الأحداث لأزرار النسخ بعد إنشاء البطاقات
    document.querySelectorAll('.card .copy-btn').forEach(btn => {
      btn.addEventListener('click', (ev) => {
        ev.stopPropagation(); // منع انتشار النقر إلى البطاقة الأم
        const credentialValueSpan = btn.previousElementSibling; // Span الذي يحتوي على النص المراد نسخه
        const textToCopy = credentialValueSpan.textContent;
        const label = btn.dataset.copyTarget === 'username' ? 'اسم المستخدم' : 'كلمة السر';
        copyText(textToCopy, label);
      });
    });

    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          // هنا يمكنك إضافة منطق لفتح تفاصيل اللعبة أو أي إجراء آخر
          card.classList.toggle('focused-state'); // مثال لتأثير بصري
        }
      });
    });
  }

  function filterGames() {
    const searchTerm = searchInput.value.trim().toLowerCase();
    const activeTypes = Array.from(filterCheckboxes)
      .filter(chk => chk.checked)
      .map(chk => chk.value);

    const filtered = games.filter(game => {
      const nameMatch = game.name.toLowerCase().includes(searchTerm);
      const typeMatch = activeTypes.length === 0 || activeTypes.includes(game.type);
      return nameMatch && typeMatch;
    });

    renderGames(filtered, searchTerm);
  }

  // زر الرجوع لأعلى
  window.addEventListener("scroll", () => {
    backToTopBtn.style.display = window.scrollY > 200 ? "block" : "none";
  });
  backToTopBtn.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  // --- معالجات الأحداث ---
  searchInput.addEventListener('input', filterGames);
  filterCheckboxes.forEach(chk => chk.addEventListener('change', filterGames));
  // تم إزالة scrollBtn.addEventListener('click') لأنه تم دمجه مع backToTopBtn

  // --- التهيئة الأولية ---
  renderGames(games);

  // --- خلفية النقاط المتوهجة ---
  const canvas = document.getElementById('mouseCanvas');
  const ctx = canvas.getContext('2d');
  let width, height;
  const particlesCount = 35;
  let particles = [];

  class Particle {
    constructor() {
      this.x = Math.random() * width;
      this.y = Math.random() * height;
      this.radius = 1 + Math.random() * 2;
      this.alpha = 0.15 + Math.random() * 0.15;
      this.vx = (Math.random() - 0.5) * 0.1;
      this.vy = (Math.random() - 0.5) * 0.1;
    }

    update() {
      this.x += this.vx;
      this.y += this.vy;
      if (this.x > width) this.x = 0;
      else if (this.x < 0) this.x = width;
      if (this.y > height) this.y = 0;
      else if (this.y < 0) this.y = height;
    }

    draw() {
      ctx.beginPath();
      const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.radius*3);
      gradient.addColorStop(0, `rgba(0,255,230,${this.alpha})`);
      gradient.addColorStop(1, 'rgba(0,255,230,0)');
      ctx.fillStyle = gradient;
      ctx.shadowColor = `rgba(0,255,230,${this.alpha})`;
      ctx.shadowBlur = 8;
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
      ctx.fill();
    }
  }

  function initParticles() {
    particles = Array.from({length: particlesCount}, () => new Particle());
  }

  function resize() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width * devicePixelRatio;
    canvas.height = height * devicePixelRatio;
    canvas.style.width = width + 'px';
    canvas.style.height = height + 'px';
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.scale(devicePixelRatio, devicePixelRatio);
  }

  function animate() {
    ctx.clearRect(0, 0, width, height);
    particles.forEach(p => {
      p.update();
      p.draw();
    });
    requestAnimationFrame(animate);
  }

  // تهيئة الجزيئات عند التحميل وتغيير حجم النافذة
  window.addEventListener('resize', resize);
  resize();
  initParticles();
  animate();
</script>
</body>
</html>
